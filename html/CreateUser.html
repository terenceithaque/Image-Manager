<!DOCTYPE html>
<html>
  <head>
    <title>Créer un nouvel utilisateur</title>
    <meta content="width=device-width,initial-scale=1" name="viewport" />
    <link rel="stylesheet" href="../css/styles.css" />
    <header>
      <a href="../index.html"
        ><img class="toolbarImage" src="../images/exit.jpg"
      /></a>
      <a href="CreateUser.html"
        ><img class="toolbarImage" src="../images/reload.jpg"
      /></a>
    </header>
  </head>

  <body>
    <div class="ConfirmBox">
      Voulez-vous vraiment nommer le nouvel utilisateur
      <span id="user-name-container">?</span>
      <button class="yes">Oui</button>
      <button class="no">Annuler</button>
    </div>

    <p>
      <strong
        >Créer un nouvel utilisateur ne supprime pas les autres
        utilisateurs.</strong
      >
    </p>
    <p>
      <strong
        >Pour pouvoir vous identifier, nous vous conseillons de mettre votre
        prénom et votre nom de famille.</strong
      >
    </p>
    <input
      class="new-user-name"
      type="text"
      placeholder="Nom du nouvel utilisateur"
    />
    <button class="name-button">Valider</button>
  </body>
  <script src="../scripts/getUserName.js"></script>

  <script>
    let elNewUser = document.querySelector(".new-user-name"); // Sélection du formulaire
    let elBoutonValider = document.querySelector(".name-button"); // Sélection du bouton de validation du nom
    elBoutonValider.setAttribute("disabled", "");

    elNewUser.addEventListener("keyup", function (e) {
      if (elNewUser.value !== "" && elBoutonValider.disabled === true) {
        elBoutonValider.disabled = false;
      } else if (elNewUser.value === "" && elBoutonValider.disabled === false) {
        elBoutonValider.disabled = true;
      }
    });

    elBoutonValider.addEventListener("click", showConfirmBox);

    let userName = ""; // Le nom de l'utilisateur  ne vaut rien au départ
    let elConfirmBox = document.querySelector(".ConfirmBox"); // Boite de dialogue de confirmation du nom d'utilisateur

    let elUserNameContainer = elConfirmBox.querySelector(
      "#user-name-container"
    );

    // elConfirmBox.innerHTML = `Voulez-vous vraiment nommer le nouvel utilisateur ${userName}`;
    // console.log(elConfirmBox.innerHTML);

    function showConfirmBox() {
      elConfirmBox.classList.add("show");
      userName = elNewUser.value;
      elUserNameContainer.innerHTML = userName;
    }

    let elBoutonYes = elConfirmBox.querySelector(".yes"); // Sélectionner le bouton "oui" de la ConfirmBox
    elBoutonYes.addEventListener("click", setUserName); // Enregistrer le nom tapé si le bouton "oui" est cliqué
    let elBoutonNo = elConfirmBox.querySelector(".no"); // Sélectionner le bouton "annuler" de la ConfirmBox
    elBoutonNo.addEventListener("click", hideConfirmBox);

    function setUserName() {
      // Créer le nom du nouvel utilisateur selon la valeur entrée
      window.localStorage.setItem("user", (name = userName));
      console.log(setUserName);
      hideConfirmBox();
    }

    function hideConfirmBox() {
      console.log("*");
      elConfirmBox.classList.remove("show");
    }
  </script>
</html>
